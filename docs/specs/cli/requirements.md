# cli モジュール要件定義書

## 概要

アプリケーションのエントリーポイントとして、CLI インターフェースを提供する。ユーザーからのコマンド入力を受け取り、適切なコンポーネントを組み立てて処理を委譲する。

## 機能要件

### コマンド実行

- `uv run example <subcommand>` の形式でサブコマンドを実行できる
- サブコマンドなしで実行した場合はヘルプを表示する
- 設定オプションの優先順位は「CLI引数 > 環境変数 > デフォルト値」とする
- エラーが発生した場合は、エラーログを出力して異常終了させる

### transform サブコマンド

- 指定したテキストファイルを変換し、結果を標準出力へ表示できる
- 処理対象のテキストファイルを、コマンド実行時に指定できる
- 出力先の一時ディレクトリを、コマンド実行時に指定できる（任意）

### グローバルオプション

- アプリケーションのログレベルを、コマンド実行時に指定できる（任意）

## CLIインターフェース仕様

### コマンド形式

```
uv run example [OPTIONS] COMMAND [ARGS]...
```

### transform サブコマンド仕様

```
uv run example transform [OPTIONS] TARGET_FILE
```

| パラメータ | 種別 | 必須 | 説明 |
|---|---|---|---|
| `TARGET_FILE` | positional argument | yes | 変換対象ファイルのパス |
| `--tmp-dir PATH` | option | no | 一時ディレクトリパス |

### グローバルオプション

| パラメータ | 種別 | 必須 | 説明 |
|---|---|---|---|
| `--log-level LEVEL` | option | no | ログレベル(CRITICAL/ERROR/WARNING/INFO/DEBUG) |

### 設定値の優先順位

- `--log-level` 引数 > `EXAMPLE_LOG_LEVEL` 環境変数 > デフォルト値(`INFO`)
- `--tmp-dir` 引数 > `EXAMPLE_TMP_DIR` 環境変数 > デフォルト値(`${PWD}/tmp`)

## 前提条件

### 技術基盤

- Typer を使用し、一貫性のあるコマンドラインインターフェイスを実現

### 終了コード

| 終了コード | 意味 |
|---|---|
| `0` | 正常終了 |
| `1` | 例外発生（エラー処理後） |
| `2` | Typer による引数エラー（不正な引数・必須引数の欠如など） |

## 関連ドキュメント

- [cli モジュール基本設計](./design.md): cli モジュールのアーキテクチャ設計やコンポーネント構成
