# foundation/model パッケージ要件定義書

## 概要

### 目的

ドメインモデルの共通制約が各モデルで個別に実装されることを防ぎ、設定の一貫性と保守性を確保する。

### 解決する課題

- ドメインモデルごとに不変性やバリデーションの設定が異なり、アプリケーション全体でのデータ整合性を保証しにくい
- モデルの設定が分散していると、設定漏れや設定ミスによって不整合なモデルが混在するリスクがある
- 共通設定を変更する際に、影響範囲が広くなり保守コストが増大する

### コンポーネントの概要

全ドメインモデルが継承すべき共通基底モデルを 1 つ提供する。この基底モデルを継承することで、以下の共通制約が自動的に適用される。各ドメインモデルは独自のフィールド定義のみに専念でき、Pydantic を介してこれらの制約が一括で機能する。

- 定義外フィールドの拒否
- 不変オブジェクトの強制
- 文字列の前後空白除去
- フィールドの複数名称アクセス

## 機能要件

### 共通基底モデルの提供

アプリケーション内の全ドメインモデルが継承できる共通の基底モデルを提供する。

- ドメインモデルは独自のフィールド定義に専念できる

### 不変オブジェクトの強制

基底モデルを継承したモデルのインスタンスは、生成後に変更できない。

### 定義外フィールドの拒否

モデルに定義されていないフィールドを含む入力を受け取った場合、バリデーションエラーを発生させる。

### 文字列の自動正規化

文字列フィールドの入力値に含まれる前後の空白を自動的に除去する。

- 呼び出し元での前処理なしに正規化された値を利用できる

### フィールドの複数名称アクセス

フィールドに別名（エイリアス）が設定されている場合、エイリアスと内部名のどちらでもデータを受け取れる。

- 外部 API のフィールド名とアプリケーション内部の命名規則が異なる場合に対応できる

## 品質要件

### 設定の一元管理

設定変更の影響範囲を基底モデルのみに局所化することで、保守コストを最小化する。

### 明示的な契約

モデルのスキーマを明示的な契約として機能させ、スキーマの不一致を早期検出できる。

## 前提条件

### 技術基盤

- データバリデーションライブラリとして Pydantic を使用する
- Pydantic のバリデーション・シリアライゼーション機能を基盤として利用する

## 関連ドキュメント

- [foundation/model パッケージ基本設計](./design.md): foundation/model パッケージのアーキテクチャ設計やコンポーネント構成
